<?page title="DOCSYS" ?>
<arya xmlns="aryaportal.org" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="aryaportal.org arya.xsd">
	<script>
	var konf = '<bean:write name="p_konf"/>';	function il_goster(il_kodu, d) {		if (!d)			d = "#xIl";		Agem.perde(true, null, "Lütfen bekleyin!");		$.ajax({"url":"genel/istatistik/select.do?tur=hepsi<%=pars%>",			data:{ sendika: $('#sendika').val(), ilKodu:il_kodu, json:1 },			async : true,			timeout: 30000, 			dataType:"text", 			success:function(data){				data = eval("("+data+")");				console.log(data);								var r = "<table cellspacing='0' cellpadding='1' border='0' style='border: 1px solid black; float: left' class='sendikayaOzel'>"+					"<tr><th colspan='3' style='background-color: #000; color: #fff'>"+data.results[0].ilAdi+"</th></tr>";				for (var i=0;i<data.results.length; i++){					if (data.results[i].ilAdi == "-") {						r += "</table>";						r += "<table cellspacing='0' cellpadding='1' border='0' style='border: 1px solid black; float: left'>"+						"<tr><th colspan='3' style='background-color: #000; color: #fff'>"+data.results[i].tur+"</th></tr>";					}					else {					    r+='<tr><td style="padding-left: 5px;">';					    r+= data.results[i].tur;					    r+= '</td><td>:</td><td style="text-align : right; padding-right: 5px">';					    r+= data.results[i].deger;					    r+= '</td></tr>';					}				}				r += "</table>";								$(d).html(r);								if ($("#tur").val().indexOf(":") == 0 || $("#tur").val() == "konf_uye_csgb" || $("#tur").val() == "konf_uye_sendika") {					$(".sendikayaOzel").hide();				}				$(d).show();				Agem.perde(false);							},			error:function(xhr,err,e){				alert('Beklenmedik Hata!..');				Agem.perde(false);			}		});			}		$(document).ready(function () {		$(".il").each( function () { 			var p = $(this).position(); 			$(this).css({ "top": (p.top+40)+"px"}); 		});		if (konf) {			$("form").append("<input type='hidden' name='sube' id='sube'>");			konf_goster();		}		else {			$("form").append("<input type='hidden' name='sendika' id='sendika'>");			tata_goster();		}					AgemWM.maximize();		$("#sube").change( function () {			ayarla();		});					$("#sendika").change( function () {			ayarla();			konf_goster();		});					$("#tur").change( function () {			if ($(this).val().indexOf(":") == 0 || $(this).val() == "konf_uye_csgb" || $(this).val() == "konf_uye_sendika") {				$(".sendikayaOzel").hide();				$("#sube").attr("disabled", true);				$("#sube").css("background-color", "#FFFFDD");				$("#sube").val("");			} else {				$(".sendikayaOzel").show();				$("#sube").removeAttr("disabled");				$("#sube").css("background-color", "white");			}			ayarla();		});				ayarla();	});		$(window).resize( function () {// 		ayarla();	});		function konf_goster() {		d = "#xUlke";		Agem.perde(true, null, "Lütfen bekleyin!");		$.ajax({"url":"genel/istatistik/select.do?ilKodu=-&konf=1&tur=toplam_csgb_uye_count",			data:{ sendika: $('#sendika').val(), json:1 },			async : true,			timeout: 30000, 			dataType:"text", 			success:function(data){				data = eval("("+data+")");				console.log(data);								var r = "<table cellspacing='0' cellpadding='1' border='0' style='border: 1px solid black; float: left' class='sendikayaOzel'>"+					"<tr><th colspan='3' style='background-color: #000; color: #fff'>"+data.results[0].ilAdi+"</th></tr>";				for (var i=0;i<data.results.length; i++){					if (data.results[i].ilAdi == "-") {						r += "</table>";						r += "<table cellspacing='0' cellpadding='1' border='0' style='border: 1px solid black; float: left'>"+						"<tr><th colspan='3' style='background-color: #000; color: #fff'>"+data.results[i].tur+"</th></tr>";					}					else {					    r+='<tr><td style="padding-left: 5px;">';					    r+= data.results[i].tur;					    r+= '</td><td>:</td><td style="text-align : right; padding-right: 5px">';					    r+= data.results[i].deger;					    r+= '</td></tr>';					}				}				r += "</table>";								$(d).html(r);								if ($("#tur").val().indexOf(":") == 0 || $("#tur").val() == "konf_uye_csgb" || $("#tur").val() == "konf_uye_sendika") {					$(".sendikayaOzel").hide();				}				$(d).show();				Agem.perde(false);			},			error:function(xhr,err,e){				alert('Beklenmedik Hata!..');				Agem.perde(false);			}		});	}		function tata_goster() {		d = "#xUlke";		Agem.perde(true, null, "Lütfen bekleyin!");		$.ajax({"url":"genel/istatistik/select.do?ilKodu=-&tur=toplam_csgb_uye_count",			data:{ sube: $('#sube').val(), json:1 },			async : true,			timeout: 30000, 			dataType:"text", 			success:function(data){				data = eval("("+data+")");				console.log(data);								var r = "<table cellspacing='0' cellpadding='1' border='0' style='border: 1px solid black; float: left' class='sendikayaOzel'>"+					"<tr><th colspan='3' style='background-color: #000; color: #fff'>"+data.results[0].ilAdi+"</th></tr>";				for (var i=0;i<data.results.length; i++){					if (data.results[i].ilAdi == "-") {						r += "</table>";						r += "<table cellspacing='0' cellpadding='1' border='0' style='border: 1px solid black; float: left'>"+						"<tr><th colspan='3' style='background-color: #000; color: #fff'>"+data.results[i].tur+"</th></tr>";					}					else {					    r+='<tr><td style="padding-left: 5px;">';					    r+= data.results[i].tur;					    r+= '</td><td>:</td><td style="text-align : right; padding-right: 5px">';					    r+= data.results[i].deger;					    r+= '</td></tr>';					}				}				r += "</table>";								$(d).html(r);								if ($("#tur").val().indexOf(":") == 0 || $("#tur").val() == "konf_uye_csgb" || $("#tur").val() == "konf_uye_sendika") {					$(".sendikayaOzel").hide();				}				$(d).show();				Agem.perde(false);			},			error:function(xhr,err,e){				alert('Beklenmedik Hata!..');				Agem.perde(false);			}		});	}	var s = 1;		var prev_s = 1;	function ayarla(y) {		console.log(y);		if (y) {			s = 1;		}		else {			s  = Math.min(($(window).width()-100)/690, ($(window).height()-300)/300);		}		var url = "genel/istatistik/select.do?sendika="+ $('#sendika').val()+"&tur="+ $('#tur').val()+"&sube="+ $('#sube').val()+"&scale="+s+"&w="+($(window).width()-50)+"&h="+($(window).height()-170);		if (y) {			url += "&yazdir=1";		}		if (konf)			url += "&konf=1";		$("#svgid").attr("data", url);		$("#svgparam").attr("value", url);		$("#svgid").css("width", $(window).width()-20);		$("#svgid").css("height", $(window).height()-280);		$("#svgid").parent().css("height", $(window).height()-280);		$("xIl").hide();				var temp = s;		s = s/prev_s;		prev_s = temp; 		$(".il").each( function () { 			var p = $(this).position();			var k = parseInt($(this).css("font-size").replace(/pt/,""));			var w = parseInt($(this).css("width").replace(/px/,"")); 			$(this).css({"width": w*s+"px", "top": ((p.top-88)*s+88)+"px", "left": ((p.left-20)*s+20)+"px", "font-size": (k*s)+"px"}); 		});	}		function excel_liste() {		AgemWM.window({url:'genel/istatistik/list.do', label: 'Liste',width: 800, height: 600, id:'istatistik_liste'});	}		function excel_harita() {		var url = "genel/istatistik/list.do?harita=1&sendika="+ $('#sendika').val()+"&tur="+ $('#tur').val()+"&sube="+ $('#sube').val();		if (konf)			url += "&konf=1";		window.open(url);	}		function pos(loc) {		t = {top: 60 - $("#test").outerHeight(), left: 10}		var k = loc.y + t.top - 5;		var l = loc.x + t.left;		$("#test").css({"top": (k)+"px", "left": (l)+"px"});		if (true)			console.log({top: (k-88)/s+88, left: (l-20)/s+20});			}		function yazdir() {		if (prev_s == 1) {			window.print();			return;		}		Agem.perde(true);		ayarla(true);	}		function yazdir_p() {		setTimeout( function () {			Agem.perde(false);			window.print();		}, 1000);	}		function degerAta(il, deger) {		$("#il"+il).html(deger);		$("#il"+il).attr("title", deger);	}			</script>
</arya>
