<?page title="DOCSYS" ?>
<arya xmlns="aryaportal.org" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="aryaportal.org arya.xsd">
	<window id="addUyecekilmeWindow">
		<label visible="false" id="uye.kisiIdlbl" value="Kisi Id" />
		<textbox visible="false" type="text" id="uye.kisiId"  value="t0g0ihade4"  placeholder=""  />
	</window>
	<script>
$(document).ready( function () {	AgemDouble.attachEvents("uye.isci.kisi.tckNo", 0);	Agem.byId("uye.cikisBasvuruTarihi").onblur = function () {		if (SON_KISI && SON_KISI.uye && SON_KISI.uye.girisBasvuruTarihi && 			AgemDate.compare(SON_KISI.uye.girisBasvuruTarihi, Agem.byId("uye.cikisBasvuruTarihi").value) <= 0 && 			(!SON_KISI.uye.girisGecerlilikTarihi || AgemDate.compare(SON_KISI.uye.girisGecerlilikTarihi, Agem.byId("uye.cikisBasvuruTarihi").value) > 0))			Agem.byId("uye.cikisGecerlilikHesaplananTarihi").value = Agem.byId("uye.cikisBasvuruTarihi").value;		else			Agem.byId("uye.cikisGecerlilikHesaplananTarihi").value = AgemDate.addDay(AgemDate.addMonth( Agem.byId("uye.cikisBasvuruTarihi").value, 1), -1);		cikisCalismaYenile();	};	Agem.byId("uye.isci.kisi.tckNo").onblur = tckNoIleKisiGetir;		Agem.addMaskEvents("uye.cikisIsyeri.sgkKisaNo");	});var tckNoIleKisiGetir = function () {	var tckNo = Agem.byId("uye.isci.kisi.tckNo").value;	if (tckNo != CIKIS_SORGULANA_SON_TCKNO && tckNo) {		Agem.ajax("genel/isci/autocomplete.do", {"kisiParam.tckNoParam": tckNo}, function (r) {			if (r && r.results && r.results.length > 0) {				setKisi(r.results[0]);			}			else {				Agem.setValue({"uye.kisiId" : "", "uye.isci.kisiId": "", "uye.isci.kisi.kisiId": "", "uye.isci.kisi.adSoyad": ""});				cikisCalismaYenile();				CIKIS_SORGULANA_SON_TCKNO = null;				Agem.byId("uyelikBilgiDiv").innerHTML = "<span class='agem-error bold'>İşçi bulunamadı.</span>";								if (!AgemValidation.tckNoValidate(tckNo)) {					Agem.byId("tckNoBilgiDiv").innerHTML = "<span class='agem-error bold'>Geçersiz T.C. Kimlik No</span>";				}				else{					Agem.byId("tckNoBilgiDiv").innerHTML = "";				}							}		});	}	else if (!tckNo) {		Agem.setValue({"uye.kisiId" : "", "uye.isci.kisiId": "", "uye.isci.kisi.kisiId": "", "uye.isci.kisi.adSoyad": ""});		cikisCalismaYenile();		CIKIS_SORGULANA_SON_TCKNO = null;		Agem.byId("uyelikBilgiDiv").innerHTML = "";		Agem.byId("tckNoBilgiDiv").innerHTML = "";	}};var isyeriBilgileriAktif = function () {	Agem.byId("uye.cikisIsyeri.sgkKisaNo").readOnly = false;	$(Agem.byId("uye.cikisIsyeri.sgkKisaNo")).removeClass("readonly");	Agem.byId("uye.cikisIsyeri.sgkKisaNo").disabled = false;	$(Agem.byId("uye.cikisIsyeri.sgkKisaNo")).removeClass("readonly");		Agem.byId("uye.cikisIsyeri.unvan").readOnly = false;	$(Agem.byId("uye.cikisIsyeri.unvan")).removeClass("readonly");	Agem.byId("uye.cikisIsyeri.unvan").disabled = false;	$(Agem.byId("uye.cikisIsyeri.unvan")).removeClass("readonly");		Agem.byId("uye.cikisIseGirisTarihi").readOnly = false;	$(Agem.byId("uye.cikisIseGirisTarihi")).removeClass("readonly");	Agem.byId("uye.cikisIseGirisTarihi").disabled = false;	$(Agem.byId("uye.cikisIseGirisTarihi")).removeClass("readonly");};var isyeriBilgileriPasif = function () {	Agem.byId("uye.cikisIsyeri.sgkKisaNo").readOnly = true;	$(Agem.byId("uye.cikisIsyeri.sgkKisaNo")).addClass("readonly");	Agem.byId("uye.cikisIsyeri.sgkKisaNo").disabled = true;	$(Agem.byId("uye.cikisIsyeri.sgkKisaNo")).addClass("readonly");		Agem.byId("uye.cikisIsyeri.unvan").readOnly = true;	$(Agem.byId("uye.cikisIsyeri.unvan")).addClass("readonly");	Agem.byId("uye.cikisIsyeri.unvan").disabled = true;	$(Agem.byId("uye.cikisIsyeri.unvan")).addClass("readonly");		Agem.byId("uye.cikisIseGirisTarihi").readOnly = true;	$(Agem.byId("uye.cikisIseGirisTarihi")).addClass("readonly");	Agem.byId("uye.cikisIseGirisTarihi").disabled = true;	$(Agem.byId("uye.cikisIseGirisTarihi")).addClass("readonly");};var SON_KISI = null;var setKisi = function (d) {	Agem.setValue(d.kisi, "uye.isci.kisi");	Agem.setValue({"uye.kisiId": d.kisiId});	Agem.setValue({"uye.isci.kisiId": d.kisiId});	Agem.setValue({"uye.isci.cinsiyet": d.cinsiyet});	if (d.uye && d.uye.girisGecerlilikTarihi && !d.uye.cikisGecerlilikTarihi) {		Agem.byId("uyelikBilgiDiv").innerHTML = "<span class='bold'>Üyelik Tarihi: </span>" + d.uye.girisGecerlilikTarihi;	}	else if (!d.uye || !d.uye.girisGecerlilikTarihi && !d.uye.cikisGecerlilikTarihi && d.uye.girisBavuruTarihi) {		Agem.byId("uyelikBilgiDiv").innerHTML = "<span class='bold'>Üyelik Başvuru Tarihi: </span>" + d.uye.girisBasvuruTarihi;	}	else {		Agem.byId("uyelikBilgiDiv").innerHTML = "<span class='agem-error bold'>Üyelik bilgisi bulunamadı.</span>";	}	SON_KISI = d;	cikisCalismaYenile();	if (d.kisi && !AgemValidation.tckNoValidate(d.kisi.tckNo)) {		Agem.byId("tckNoBilgiDiv").innerHTML = "<span class='agem-error bold'>Geçersiz T.C. Kimlik No</span>";	}	else{		Agem.byId("tckNoBilgiDiv").innerHTML = "<span class='agem-error bold'></span>";	}	};var prepareKisiUrl = function () {	return "genel/isci/autocomplete.do";};var prepareAdSoyadParameterName = function () {	return "kisiParam.adSoyadParam";};var prepareTCKimlikNoParameterName = function () {	return "kisiParam.tckNoParam";};var setCikisIsyeri = function (d) {	Agem.setValue(d, "uye.cikisIsyeri")};var CIKIS_SORGULANA_SON_TARIH = null;var CIKIS_SORGULANA_SON_TCKNO = null;var cikisCalismaYenile = function(force) {	if (Agem.byId("uye.isci.kisi.tckNo").value && Agem.byId("uye.cikisBasvuruTarihi").value) {		var tarih = Agem.byId("uye.cikisBasvuruTarihi").value;		var tckNo = Agem.byId("uye.isci.kisi.tckNo").value;		if (tarih == CIKIS_SORGULANA_SON_TARIH && tckNo == CIKIS_SORGULANA_SON_TCKNO && !force)			return;		CIKIS_SORGULANA_SON_TARIH = tarih;		CIKIS_SORGULANA_SON_TCKNO = tckNo;		Agem.ajax("genel/calisan/autocomplete.do", 			{pageSize:1, "kisiParam.tckNoEsitParam": tckNo, "tarihParam": tarih}, 			function (d) {				if(d.results && d.results.length > 0) {					var data = d.results[0];					Agem.setValue(						{							"uye.cikisIsyeri.isyeriId": data.isyeriId, 							"uye.cikisIsyeri.sgkKisaNo": data.isyeri.sgkKisaNo, 							"uye.cikisIseGirisTarihi": data.girisTarihi,  						  	"uye.cikisIsyeri.unvan": data.isyeri.unvan,						  	"uye.calismaKaydiOlustur": 0									  							}					);										isyeriBilgileriPasif();				}				else {					Agem.setValue(						{							"uye.cikisIsyeri.isyeriId": "", 							"uye.cikisIsyeri.sgkKisaNo": "", 							"uye.cikisIseGirisTarihi": "",  						  	"uye.cikisIsyeri.unvan": "",						  	"uye.calismaKaydiOlustur": 1						}					);					isyeriBilgileriAktif();				}			}		);	}	else {		Agem.setValue(			{				"uye.cikisIsyeri.isyeriId": "", 				"uye.cikisIsyeri.sgkKisaNo": "", 				"uye.cikisIseGirisTarihi": "",  			  	"uye.cikisIsyeri.unvan": "",			  	"uye.calismaKaydiOlustur": 1			  				}		);		isyeriBilgileriAktif();	}//   	alert($(Agem.byId(" uye.cikisIsyeri.sgkKisaNo")).val());	return true;};var kaydet = function () {	if (AgemForm.validate(document.forms[0])) {		Agem.ajax(			"genel/uyeCekilme/edit.do", AgemForm.form2json(document.forms[0]),				function(d){					if(d['@hata']){						Agem.message(d['@message']);					} else {						d.uye.cikisIsyeri.sgkKisaNo = $(Agem.byId("uye.cikisIsyeri.sgkKisaNo")).val();						$("#liste").addRow({							data: [d.uye.isci.kisi.tckNo, d.uye.isci.kisi.adSoyad, d.uye.cikisBasvuruTarihi, d.uye.cikisGecerlilikTarihi, d.uye.calismaKaydiOlustur],							clazz: ["right", "", "center", "center", "center", "center"],							json: d,							id: d.uye.uyeId,							prepend: true,							replace: true,							selectRow: true						});						Agem.setValue(d);						Agem.message(d["@message"]);					}				}			);	}};AgemTable.rowClick = function (id) {	var r = AgemTable.DATA["d-"+id];	Agem.setValue(r);	//girisCalismaYenile();};var ek6Yukle = function() {	Other.nesneDosyaYukle('uyeEk6',$('#uye\\.uyeId').val(),$('#uye\\.isci\\.kisi\\.adSoyad').val() + ' - Üye Ek6');};var yeniKayit = function () {	Agem.setValue(		{			"uye.uyeId": "",			"uye.kisiId": "",			"uye.isci.kisiId": "",			"uye.isci.kisi.kisiId": "",			"uye.isci.kisi.tckNo": "",			"uye.isci.kisi.adSoyad": "",			"uye.cikisIsyeri.isyeriId": "", 			"uye.cikisIsyeri.sgkKisaNo": "", 			"uye.cikisIseGirisTarihi": "",  		  	"uye.cikisIsyeri.unvan": ""		}	);	CIKIS_SORGULANA_SON_TCKNO = null;};var sil = function() {	var x = Agem.byId("uye.uyeId").value;	if (x) {		Agem.ajax("genel/uyeCekilme/delete.do", {json: 1, "uye.uyeId": x}, function (d) {			$("#liste").removeRow( {id: Agem.byId("uye.uyeId").value});			yeniKayit();		});	}} var isciyeGit = function() {	if (Agem.byId("uye.isci.kisiId").value)		AgemWM.window( {link: "genel/isci/select.do?kisiId="+Agem.byId("uye.isci.kisiId").value, width: 800, height: 600, label: "İşçi İşlemleri"});};var girisCalismaGit = function() {	if (Agem.byId("uye.isci.kisiId").value)		AgemWM.window( {tab:"#genelIsciCalisanList", url: "genel/isci/main.do", q: "kisiId="+Agem.byId("uye.isci.kisiId").value, width: 800, height: 600, label: "İşçi İşlemleri"});	};var cikisCalismaGit = girisCalismaGit;	</script>
</arya>
